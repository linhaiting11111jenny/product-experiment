# å®éªŒæ•°æ®ä¿å­˜ä½ç½®è¯´æ˜

## ğŸ“ æ•°æ®ä¿å­˜ä½ç½®

å®éªŒæ•°æ®ä¼šåœ¨**å¤šä¸ªä½ç½®**ä¿å­˜ï¼Œç¡®ä¿æ•°æ®ä¸ä¸¢å¤±ï¼š

### 1. æµè§ˆå™¨ localStorageï¼ˆä¸»è¦å­˜å‚¨ï¼‰

**ä½ç½®**ï¼šæµè§ˆå™¨çš„æœ¬åœ°å­˜å‚¨ï¼ˆlocalStorageï¼‰

**é”®å**ï¼š`experimentData`

**ä¿å­˜æ—¶æœº**ï¼šç‚¹å‡»"å®Œæˆæµè§ˆï¼Œè¿”å›é—®å·"æŒ‰é’®æ—¶

**æ•°æ®æ ¼å¼**ï¼šJSON å­—ç¬¦ä¸²

**å¦‚ä½•æŸ¥çœ‹**ï¼š
1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
2. åˆ‡æ¢åˆ° **Application**ï¼ˆChromeï¼‰æˆ– **å­˜å‚¨**ï¼ˆFirefoxï¼‰æ ‡ç­¾
3. å·¦ä¾§æ‰¾åˆ° **Local Storage**
4. ç‚¹å‡»ä½ çš„ç½‘ç«™åŸŸå
5. æ‰¾åˆ° `experimentData` é”®ï¼ŒæŸ¥çœ‹å…¶å€¼

**æˆ–è€…ä½¿ç”¨æ§åˆ¶å°æŸ¥çœ‹**ï¼š
```javascript
// åœ¨æµè§ˆå™¨æ§åˆ¶å°ï¼ˆConsoleï¼‰ä¸­æ‰§è¡Œ
const data = JSON.parse(localStorage.getItem('experimentData'));
console.log(data);
```

### 2. postMessage å‘é€ç»™çˆ¶çª—å£ï¼ˆCredamo åµŒå…¥æ—¶ï¼‰

**ä½ç½®**ï¼šé€šè¿‡ `window.postMessage` å‘é€ç»™ Credamo çˆ¶çª—å£

**è§¦å‘æ¡ä»¶**ï¼šé¡µé¢åœ¨ iframe ä¸­ä¸”ç‚¹å‡»"å®Œæˆæµè§ˆï¼Œè¿”å›é—®å·"æŒ‰é’®

**æ•°æ®æ ¼å¼**ï¼š
```javascript
{
    type: 'experiment_complete',
    data: {
        view_reviews: true/false,
        click_view_reviews: "2024-01-01T12:00:00.000Z",
        click_load_more: [...],
        condition: "rating",
        return_timestamp: "2024-01-01T12:05:00.000Z",
        page_load_time: "2024-01-01T12:00:00.000Z"
    }
}
```

**å¦‚ä½•æ¥æ”¶**ï¼ˆåœ¨ Credamo ä¸­ï¼‰ï¼š
```javascript
window.addEventListener('message', function(event) {
    if (event.data && event.data.type === 'experiment_complete') {
        const experimentData = event.data.data;
        console.log('å®éªŒæ•°æ®ï¼š', experimentData);
        // ä¿å­˜åˆ° Credamo å˜é‡ä¸­
    }
});
```

### 3. URL å‚æ•°ä¼ é€’ï¼ˆè®¾ç½®äº† return_url æ—¶ï¼‰

**ä½ç½®**ï¼šURL æŸ¥è¯¢å‚æ•°

**è§¦å‘æ¡ä»¶**ï¼šè®¾ç½®äº† `return_url` å‚æ•°ä¸”ç‚¹å‡»"å®Œæˆæµè§ˆï¼Œè¿”å›é—®å·"æŒ‰é’®

**URL æ ¼å¼**ï¼š
```
https://credamo.com/your-survey/next-page?experiment_data={"view_reviews":true,"click_view_reviews":"2024-01-01T12:00:00.000Z",...}
```

**å¦‚ä½•è·å–**ï¼ˆåœ¨ Credamo çš„ä¸‹ä¸€ä¸ªé¡µé¢ä¸­ï¼‰ï¼š
```javascript
const urlParams = new URLSearchParams(window.location.search);
const experimentData = JSON.parse(urlParams.get('experiment_data') || '{}');
console.log(experimentData);
```

## ğŸ“Š æ•°æ®å­—æ®µè¯´æ˜

å®éªŒæ•°æ®åŒ…å«ä»¥ä¸‹å­—æ®µï¼š

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|
| `view_reviews` | Boolean | æ˜¯å¦ç‚¹å‡»äº†"æŸ¥çœ‹åŸå§‹è¯„è®º" | `true` æˆ– `false` |
| `click_view_reviews` | String | ç‚¹å‡»"æŸ¥çœ‹åŸå§‹è¯„è®º"çš„æ—¶é—´æˆ³ï¼ˆISOæ ¼å¼ï¼‰ | `"2024-01-01T12:00:00.000Z"` |
| `click_load_more` | Array | æ¯æ¬¡ç‚¹å‡»"åŠ è½½æ›´å¤šè¯„è®º"çš„è®°å½• | `[{count: 1, timestamp: "..."}, ...]` |
| `condition` | String | å®éªŒæ¡ä»¶ | `"rating"` / `"aigrs_neutral"` / `"aigrs_positive"` |
| `return_timestamp` | String | ç‚¹å‡»"å®Œæˆæµè§ˆï¼Œè¿”å›é—®å·"çš„æ—¶é—´æˆ³ | `"2024-01-01T12:05:00.000Z"` |
| `page_load_time` | String | é¡µé¢é¦–æ¬¡åŠ è½½çš„æ—¶é—´æˆ³ | `"2024-01-01T12:00:00.000Z"` |

### click_load_more æ•°ç»„ç¤ºä¾‹

```javascript
[
    { count: 1, timestamp: "2024-01-01T12:01:00.000Z" },
    { count: 2, timestamp: "2024-01-01T12:02:00.000Z" },
    { count: 3, timestamp: "2024-01-01T12:03:00.000Z" }
]
```

## ğŸ” å¦‚ä½•æŸ¥çœ‹å’Œå¯¼å‡ºæ•°æ®

### æ–¹æ³• 1ï¼šæµè§ˆå™¨å¼€å‘è€…å·¥å…·

1. æ‰“å¼€å®éªŒé¡µé¢
2. æŒ‰ `F12` æ‰“å¼€å¼€å‘è€…å·¥å…·
3. åˆ‡æ¢åˆ° **Application** æ ‡ç­¾ï¼ˆChromeï¼‰æˆ– **å­˜å‚¨** æ ‡ç­¾ï¼ˆFirefoxï¼‰
4. å·¦ä¾§å±•å¼€ **Local Storage**
5. ç‚¹å‡»ä½ çš„ç½‘ç«™åŸŸå
6. æ‰¾åˆ° `experimentData`ï¼Œå³é”®é€‰æ‹© **Copy** å¤åˆ¶æ•°æ®

### æ–¹æ³• 2ï¼šæµè§ˆå™¨æ§åˆ¶å°

```javascript
// è·å–æ•°æ®
const data = JSON.parse(localStorage.getItem('experimentData'));

// æŸ¥çœ‹æ•°æ®
console.log(data);

// æ ¼å¼åŒ–æ˜¾ç¤º
console.log(JSON.stringify(data, null, 2));

// å¯¼å‡ºä¸ºæ–‡ä»¶ï¼ˆåœ¨æµè§ˆå™¨ä¸­ï¼‰
const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
const url = URL.createObjectURL(blob);
const a = document.createElement('a');
a.href = url;
a.download = 'experiment-data.json';
a.click();
```

### æ–¹æ³• 3ï¼šåœ¨ Credamo ä¸­è‡ªåŠ¨æ”¶é›†

å¦‚æœæ­£ç¡®é…ç½®äº† Credamoï¼Œæ•°æ®ä¼šè‡ªåŠ¨é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¼ é€’ï¼š

1. **postMessage**ï¼šCredamo çˆ¶é¡µé¢æ¥æ”¶æ•°æ®
2. **URL å‚æ•°**ï¼šæ•°æ®ç¼–ç åœ¨ URL ä¸­ï¼ŒCredamo å¯ä»¥è§£æå¹¶ä¿å­˜

## âš ï¸ é‡è¦æç¤º

1. **localStorage æ˜¯æœ¬åœ°å­˜å‚¨**ï¼š
   - æ•°æ®åªä¿å­˜åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­
   - æ¸…é™¤æµè§ˆå™¨æ•°æ®ä¼šåˆ é™¤è¿™äº›æ•°æ®
   - ä¸åŒæµè§ˆå™¨/è®¾å¤‡ä¹‹é—´ä¸å…±äº«

2. **æ•°æ®æŒä¹…æ€§**ï¼š
   - localStorage æ•°æ®ä¼šä¸€ç›´ä¿å­˜ï¼Œç›´åˆ°ç”¨æˆ·æ¸…é™¤æµè§ˆå™¨æ•°æ®
   - å»ºè®®åœ¨ Credamo ä¸­åŠæ—¶æ”¶é›†å’Œä¿å­˜æ•°æ®

3. **éšç§è€ƒè™‘**ï¼š
   - å®éªŒæ•°æ®åŒ…å«ç”¨æˆ·è¡Œä¸ºæ—¶é—´æˆ³
   - ç¡®ä¿ç¬¦åˆæ•°æ®ä¿æŠ¤æ³•è§„è¦æ±‚

4. **æ•°æ®æ”¶é›†å»ºè®®**ï¼š
   - åœ¨ Credamo ä¸­è®¾ç½®è‡ªåŠ¨æ”¶é›†æœºåˆ¶
   - å®šæœŸå¯¼å‡ºæ•°æ®å¤‡ä»½
   - ä¸è¦ä»…ä¾èµ– localStorage

## ğŸ“ å®Œæ•´æ•°æ®ç¤ºä¾‹

```json
{
  "view_reviews": true,
  "click_view_reviews": "2024-01-15T10:30:45.123Z",
  "click_load_more": [
    {
      "count": 1,
      "timestamp": "2024-01-15T10:31:20.456Z"
    },
    {
      "count": 2,
      "timestamp": "2024-01-15T10:32:10.789Z"
    }
  ],
  "condition": "aigrs_positive",
  "return_timestamp": "2024-01-15T10:35:00.000Z",
  "page_load_time": "2024-01-15T10:30:00.000Z"
}
```

## ğŸ› ï¸ å¦‚æœéœ€è¦ä¿®æ”¹æ•°æ®ä¿å­˜æ–¹å¼

å¦‚æœä½ æƒ³å°†æ•°æ®ç›´æ¥å‘é€åˆ°æœåŠ¡å™¨ï¼Œå¯ä»¥ä¿®æ”¹ `index.html` ä¸­è¿”å›æŒ‰é’®çš„äº‹ä»¶å¤„ç†ï¼Œæ·»åŠ  AJAX è¯·æ±‚ï¼š

```javascript
// å‘é€åˆ°æœåŠ¡å™¨
fetch('https://your-server.com/api/experiment-data', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
    },
    body: JSON.stringify(finalData)
});
```

