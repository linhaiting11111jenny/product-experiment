# å®éªŒæ•°æ®å­—æ®µè¯´æ˜

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜å®éªŒé¡µé¢è®°å½•çš„æ‰€æœ‰æ•°æ®å­—æ®µã€æ•°æ®ä¿å­˜ä½ç½®å’ŒæŸ¥çœ‹æ–¹æ³•ã€‚

## ğŸ“Š å®Œæ•´æ•°æ®å­—æ®µåˆ—è¡¨

å®éªŒæ•°æ®åŒ…å«ä»¥ä¸‹å­—æ®µï¼š

```javascript
{
  // é—®å·å’Œç”¨æˆ·æ ‡è¯†
  survey_id: "12345",              // é—®å·IDï¼ˆå¿…éœ€ï¼‰
  user_id: "user123",              // ç”¨æˆ·IDï¼ˆå¯é€‰ï¼‰
  respondent_id: "resp456",        // å—è®¿è€…IDï¼ˆå¯é€‰ï¼‰
  
  // å®éªŒæ¡ä»¶
  condition: "rating",             // "rating" / "aigrs_neutral" / "aigrs_positive"
  
  // æ—¶é—´æˆ³è®°å½•
  link_click_time: "2024-01-15T10:30:00.000Z",           // ç‚¹å‡»é“¾æ¥æ—¶é—´
  page_load_time: "2024-01-15T10:30:00.100Z",           // é¡µé¢å¼€å§‹åŠ è½½
  dom_content_loaded_time: "2024-01-15T10:30:00.500Z",  // DOMåŠ è½½å®Œæˆ
  page_load_complete_time: "2024-01-15T10:30:01.000Z",  // é¡µé¢å®Œå…¨åŠ è½½
  
  // äº¤äº’è¡Œä¸º
  view_reviews: true,                                    // æ˜¯å¦æŸ¥çœ‹è¯„è®º
  click_view_reviews: "2024-01-15T10:31:00.000Z",       // ç‚¹å‡»æŸ¥çœ‹è¯„è®ºæ—¶é—´
  reviews_expanded_time: "2024-01-15T10:31:00.100Z",    // è¯„è®ºå±•å¼€å®Œæˆæ—¶é—´
  
  // åŠ è½½æ›´å¤šè¡Œä¸º
  click_load_more: [
    {
      count: 1,
      timestamp: "2024-01-15T10:32:00.000Z",
      before_scroll_position: 500,
      after_scroll_position: 1200,
      load_complete_time: "2024-01-15T10:32:00.150Z"
    },
    {
      count: 2,
      timestamp: "2024-01-15T10:33:00.000Z",
      before_scroll_position: 1200,
      after_scroll_position: 2000,
      load_complete_time: "2024-01-15T10:33:00.120Z"
    }
  ],
  total_load_more_clicks: 2,
  
  // é¡µé¢åœç•™æ—¶é—´
  return_click_time: "2024-01-15T10:35:00.000Z",        // ç‚¹å‡»è¿”å›æ—¶é—´
  return_timestamp: "2024-01-15T10:35:00.000Z",         // è¿”å›æ—¶é—´æˆ³ï¼ˆåŒreturn_click_timeï¼‰
  total_stay_time_ms: 300000,                           // æ€»åœç•™æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
  total_stay_time_seconds: 300,                         // æ€»åœç•™æ—¶é—´ï¼ˆç§’ï¼‰
  
  // å…¶ä»–
  page_leave_time: "2024-01-15T10:35:00.100Z"          // ç¦»å¼€é¡µé¢æ—¶é—´ï¼ˆå¦‚æœå¯æ£€æµ‹ï¼‰
}
```

## ğŸ“‹ å­—æ®µè¯¦ç»†è¯´æ˜

### é—®å·å’Œç”¨æˆ·æ ‡è¯†

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | æ¥æº |
|--------|------|------|------|
| `survey_id` | String | é—®å·IDï¼ˆç”¨äºå…³è”æ•°æ®ï¼‰ | URLå‚æ•° `survey_id` |
| `user_id` | String \| null | ç”¨æˆ·IDï¼ˆå¯é€‰ï¼‰ | URLå‚æ•° `user_id` |
| `respondent_id` | String \| null | å—è®¿è€…IDï¼ˆå¯é€‰ï¼‰ | URLå‚æ•° `respondent_id` |

### å®éªŒæ¡ä»¶

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | å¯èƒ½å€¼ |
|--------|------|------|--------|
| `condition` | String | å®éªŒæ¡ä»¶ | `"rating"` / `"aigrs_neutral"` / `"aigrs_positive"` |

### æ—¶é—´æˆ³è®°å½•

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | è®°å½•æ—¶æœº |
|--------|------|------|----------|
| `link_click_time` | String \| null | ç‚¹å‡»é“¾æ¥è¿›å…¥é¡µé¢çš„æ—¶é—´æˆ³ | ä»URLå‚æ•°è·å–æˆ–è®°å½•é¡µé¢åŠ è½½æ—¶é—´ |
| `page_load_time` | String | é¡µé¢å¼€å§‹åŠ è½½çš„æ—¶é—´æˆ³ | é¡µé¢å¼€å§‹åŠ è½½æ—¶ |
| `dom_content_loaded_time` | String | DOMå†…å®¹åŠ è½½å®Œæˆçš„æ—¶é—´æˆ³ | DOMContentLoadedäº‹ä»¶ |
| `page_load_complete_time` | String | é¡µé¢å®Œå…¨åŠ è½½å®Œæˆçš„æ—¶é—´æˆ³ | window.loadäº‹ä»¶ |

### äº¤äº’è¡Œä¸ºè®°å½•

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | è®°å½•æ—¶æœº |
|--------|------|------|----------|
| `view_reviews` | Boolean | æ˜¯å¦ç‚¹å‡»äº†"æŸ¥çœ‹åŸå§‹è¯„è®º" | ç‚¹å‡»"æŸ¥çœ‹åŸå§‹è¯„è®º"æŒ‰é’®æ—¶ |
| `click_view_reviews` | String \| null | ç‚¹å‡»"æŸ¥çœ‹åŸå§‹è¯„è®º"çš„æ—¶é—´æˆ³ | ç‚¹å‡»"æŸ¥çœ‹åŸå§‹è¯„è®º"æŒ‰é’®æ—¶ |
| `reviews_expanded_time` | String \| null | è¯„è®ºå±•å¼€å®Œæˆçš„æ—¶é—´æˆ³ | è¯„è®ºDOMæ›´æ–°å®Œæˆåï¼ˆå»¶è¿Ÿ100msï¼‰ |

### åŠ è½½æ›´å¤šè¡Œä¸ºè®°å½•

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `click_load_more` | Array | æ¯æ¬¡ç‚¹å‡»"åŠ è½½æ›´å¤šè¯„è®º"çš„è¯¦ç»†è®°å½•æ•°ç»„ |
| `total_load_more_clicks` | Number | æ€»å…±ç‚¹å‡»"åŠ è½½æ›´å¤š"çš„æ¬¡æ•° |

#### `click_load_more` æ•°ç»„å…ƒç´ ç»“æ„

æ¯ä¸ªå…ƒç´ åŒ…å«ï¼š

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `count` | Number | ç¬¬å‡ æ¬¡ç‚¹å‡»ï¼ˆä»1å¼€å§‹ï¼‰ |
| `timestamp` | String | ç‚¹å‡»æ—¶é—´æˆ³ï¼ˆISOæ ¼å¼ï¼‰ |
| `before_scroll_position` | Number | ç‚¹å‡»å‰çš„æ»šåŠ¨ä½ç½®ï¼ˆåƒç´ ï¼‰ |
| `after_scroll_position` | Number | åŠ è½½å®Œæˆåçš„æ»šåŠ¨ä½ç½®ï¼ˆåƒç´ ï¼‰ |
| `load_complete_time` | String | åŠ è½½å®Œæˆçš„æ—¶é—´æˆ³ï¼ˆå»¶è¿Ÿ100msåè®°å½•ï¼‰ |

### é¡µé¢åœç•™æ—¶é—´

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `return_click_time` | String \| null | ç‚¹å‡»"å®Œæˆæµè§ˆï¼Œè¿”å›é—®å·"çš„æ—¶é—´æˆ³ |
| `return_timestamp` | String \| null | è¿”å›æ—¶é—´æˆ³ï¼ˆåŒreturn_click_timeï¼‰ |
| `total_stay_time_ms` | Number | æ€»åœç•™æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼Œä»`page_load_time`åˆ°`return_click_time` |
| `total_stay_time_seconds` | Number | æ€»åœç•™æ—¶é—´ï¼ˆç§’ï¼‰ï¼Œå››èˆäº”å…¥ |

### å…¶ä»–è®°å½•

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `page_leave_time` | String \| null | ç¦»å¼€é¡µé¢çš„æ—¶é—´æˆ³ï¼ˆå¦‚æœå¯æ£€æµ‹ï¼‰ |

## ğŸ¯ è¡Œä¸ºè®°å½•æ—¶é—´çº¿

å…¸å‹çš„æ—¶é—´çº¿ç¤ºä¾‹ï¼š

```
10:30:00.000 - link_click_time (ç‚¹å‡»é“¾æ¥)
10:30:00.100 - page_load_time (é¡µé¢å¼€å§‹åŠ è½½)
10:30:00.500 - dom_content_loaded_time (DOMåŠ è½½å®Œæˆ)
10:30:01.000 - page_load_complete_time (é¡µé¢å®Œå…¨åŠ è½½)
10:31:00.000 - click_view_reviews (ç‚¹å‡»æŸ¥çœ‹è¯„è®º)
10:31:00.100 - reviews_expanded_time (è¯„è®ºå±•å¼€å®Œæˆ)
10:32:00.000 - click_load_more[0].timestamp (ç¬¬1æ¬¡åŠ è½½æ›´å¤š)
10:32:00.150 - click_load_more[0].load_complete_time (ç¬¬1æ¬¡åŠ è½½å®Œæˆ)
10:33:00.000 - click_load_more[1].timestamp (ç¬¬2æ¬¡åŠ è½½æ›´å¤š)
10:33:00.120 - click_load_more[1].load_complete_time (ç¬¬2æ¬¡åŠ è½½å®Œæˆ)
10:35:00.000 - return_click_time (ç‚¹å‡»è¿”å›)
10:35:00.100 - page_leave_time (ç¦»å¼€é¡µé¢)
```

## ğŸ“ æ•°æ®ä¿å­˜ä½ç½®

å®éªŒæ•°æ®ä¼šåœ¨**å¤šä¸ªä½ç½®**ä¿å­˜ï¼Œç¡®ä¿æ•°æ®ä¸ä¸¢å¤±ï¼š

### 1. æµè§ˆå™¨ localStorageï¼ˆä¸»è¦å­˜å‚¨ï¼‰

**ä½ç½®**ï¼šæµè§ˆå™¨çš„æœ¬åœ°å­˜å‚¨ï¼ˆlocalStorageï¼‰

**é”®å**ï¼š`experimentData`

**ä¿å­˜æ—¶æœº**ï¼šç‚¹å‡»"å®Œæˆæµè§ˆï¼Œè¿”å›é—®å·"æŒ‰é’®æ—¶

**æ•°æ®æ ¼å¼**ï¼šJSON å­—ç¬¦ä¸²

**å¦‚ä½•æŸ¥çœ‹**ï¼š
1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
2. åˆ‡æ¢åˆ° **Application**ï¼ˆChromeï¼‰æˆ– **å­˜å‚¨**ï¼ˆFirefoxï¼‰æ ‡ç­¾
3. å·¦ä¾§æ‰¾åˆ° **Local Storage**
4. ç‚¹å‡»ä½ çš„ç½‘ç«™åŸŸå
5. æ‰¾åˆ° `experimentData` é”®ï¼ŒæŸ¥çœ‹å…¶å€¼

**æˆ–è€…ä½¿ç”¨æ§åˆ¶å°æŸ¥çœ‹**ï¼š
```javascript
// åœ¨æµè§ˆå™¨æ§åˆ¶å°ï¼ˆConsoleï¼‰ä¸­æ‰§è¡Œ
const data = JSON.parse(localStorage.getItem('experimentData'));
console.log(data);
```

### 2. postMessage å‘é€ç»™çˆ¶çª—å£ï¼ˆCredamoåµŒå…¥æ—¶ï¼‰

**ä½ç½®**ï¼šé€šè¿‡ `window.postMessage` å‘é€ç»™Credamoçˆ¶çª—å£

**è§¦å‘æ¡ä»¶**ï¼šé¡µé¢åœ¨iframeä¸­ä¸”ç‚¹å‡»"å®Œæˆæµè§ˆï¼Œè¿”å›é—®å·"æŒ‰é’®

**æ•°æ®æ ¼å¼**ï¼š
```javascript
{
    type: 'experiment_complete',
    data: {
        // å®Œæ•´çš„å®éªŒæ•°æ®å¯¹è±¡
    }
}
```

### 3. URL å‚æ•°ä¼ é€’ï¼ˆè®¾ç½®äº†return_urlæ—¶ï¼‰

**ä½ç½®**ï¼šURL æŸ¥è¯¢å‚æ•°

**è§¦å‘æ¡ä»¶**ï¼šè®¾ç½®äº† `return_url` å‚æ•°ä¸”ç‚¹å‡»"å®Œæˆæµè§ˆï¼Œè¿”å›é—®å·"æŒ‰é’®

**URL æ ¼å¼**ï¼š
```
https://credamo.com/your-survey/next-page?experiment_data={"view_reviews":true,"click_view_reviews":"2024-01-01T12:00:00.000Z",...}
```

**å¦‚ä½•è·å–**ï¼ˆåœ¨Credamoçš„ä¸‹ä¸€ä¸ªé¡µé¢ä¸­ï¼‰ï¼š
```javascript
const urlParams = new URLSearchParams(window.location.search);
const experimentData = JSON.parse(urlParams.get('experiment_data') || '{}');
console.log(experimentData);
```

## ğŸ” å¦‚ä½•æŸ¥çœ‹å’Œå¯¼å‡ºæ•°æ®

### æ–¹æ³• 1ï¼šæµè§ˆå™¨å¼€å‘è€…å·¥å…·

1. æ‰“å¼€å®éªŒé¡µé¢
2. æŒ‰ `F12` æ‰“å¼€å¼€å‘è€…å·¥å…·
3. åˆ‡æ¢åˆ° **Application** æ ‡ç­¾ï¼ˆChromeï¼‰æˆ– **å­˜å‚¨** æ ‡ç­¾ï¼ˆFirefoxï¼‰
4. å·¦ä¾§å±•å¼€ **Local Storage**
5. ç‚¹å‡»ä½ çš„ç½‘ç«™åŸŸå
6. æ‰¾åˆ° `experimentData`ï¼Œå³é”®é€‰æ‹© **Copy** å¤åˆ¶æ•°æ®

### æ–¹æ³• 2ï¼šæµè§ˆå™¨æ§åˆ¶å°

```javascript
// è·å–æ•°æ®
const data = JSON.parse(localStorage.getItem('experimentData'));

// æŸ¥çœ‹æ•°æ®
console.log(data);

// æ ¼å¼åŒ–æ˜¾ç¤º
console.log(JSON.stringify(data, null, 2));

// å¯¼å‡ºä¸ºæ–‡ä»¶ï¼ˆåœ¨æµè§ˆå™¨ä¸­ï¼‰
const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
const url = URL.createObjectURL(blob);
const a = document.createElement('a');
a.href = url;
a.download = 'experiment-data.json';
a.click();
```

### æ–¹æ³• 3ï¼šåœ¨ Credamo ä¸­è‡ªåŠ¨æ”¶é›†

å¦‚æœæ­£ç¡®é…ç½®äº†Credamoï¼Œæ•°æ®ä¼šè‡ªåŠ¨é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¼ é€’ï¼š

1. **postMessage**ï¼šCredamoçˆ¶é¡µé¢æ¥æ”¶æ•°æ®
2. **URLå‚æ•°**ï¼šæ•°æ®ç¼–ç åœ¨URLä¸­ï¼ŒCredamoå¯ä»¥è§£æå¹¶ä¿å­˜

è¯¦ç»†é…ç½®æ–¹æ³•è¯·æŸ¥çœ‹ [Credamoé…ç½®æŒ‡å—.md](Credamoé…ç½®æŒ‡å—.md)

## ğŸ“‹ æ•°æ®å¯¼å‡ºè¡¨æ ¼ç»“æ„

åœ¨Credamoä¸­å¯¼å‡ºæ•°æ®æ—¶ï¼Œå»ºè®®çš„è¡¨æ ¼åˆ—ï¼š

| survey_id | condition | link_click_time | page_load_time | page_load_complete_time | view_reviews | click_view_reviews | reviews_expanded_time | total_load_more_clicks | return_click_time | total_stay_time_seconds | ... |
|-----------|-----------|-----------------|----------------|-------------------------|--------------|---------------------|----------------------|------------------------|-------------------|-------------------------|-----|
| 12345 | rating | 2024-01-15T10:30:00.000Z | 2024-01-15T10:30:00.100Z | 2024-01-15T10:30:01.000Z | true | 2024-01-15T10:31:00.000Z | 2024-01-15T10:31:00.100Z | 2 | 2024-01-15T10:35:00.000Z | 300 | ... |

## âš ï¸ é‡è¦æç¤º

1. **æ—¶é—´æˆ³æ ¼å¼**ï¼šæ‰€æœ‰æ—¶é—´æˆ³ä½¿ç”¨ ISO 8601 æ ¼å¼ï¼ˆä¾‹å¦‚ï¼š`2024-01-15T10:30:00.000Z`ï¼‰ï¼Œä¾¿äºåç»­åˆ†æå’Œå¤„ç†
2. **æ—¶é—´ç²¾åº¦**ï¼šæ—¶é—´æˆ³ç²¾ç¡®åˆ°æ¯«ç§’
3. **æ•°æ®å®Œæ•´æ€§**ï¼šå³ä½¿è¢«è¯•ä¸è¿›è¡Œä»»ä½•æ“ä½œï¼Œä¹Ÿä¼šè®°å½•é¡µé¢åŠ è½½ç›¸å…³çš„æ—¶é—´æˆ³
4. **æ•°æ®å…³è”**ï¼šæ‰€æœ‰æ•°æ®éƒ½é€šè¿‡ `survey_id` ä¸é—®å·ç­”æ¡ˆå…³è”
5. **localStorageé™åˆ¶**ï¼š
   - æ•°æ®åªä¿å­˜åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­
   - æ¸…é™¤æµè§ˆå™¨æ•°æ®ä¼šåˆ é™¤è¿™äº›æ•°æ®
   - ä¸åŒæµè§ˆå™¨/è®¾å¤‡ä¹‹é—´ä¸å…±äº«
   - å»ºè®®åœ¨Credamoä¸­åŠæ—¶æ”¶é›†å’Œä¿å­˜æ•°æ®
6. **éšç§è€ƒè™‘**ï¼šå®éªŒæ•°æ®åŒ…å«ç”¨æˆ·è¡Œä¸ºæ—¶é—´æˆ³ï¼Œç¡®ä¿ç¬¦åˆæ•°æ®ä¿æŠ¤æ³•è§„è¦æ±‚

## ğŸ” å¦‚ä½•éªŒè¯è¡Œä¸ºè®°å½•

### æ–¹æ³•1ï¼šæµè§ˆå™¨æ§åˆ¶å°
```javascript
// åœ¨å®éªŒé¡µé¢æ‰“å¼€æ§åˆ¶å°ï¼ˆF12ï¼‰ï¼Œæ‰§è¡Œï¼š
const data = JSON.parse(localStorage.getItem('experimentData'));
console.log(data);
```

### æ–¹æ³•2ï¼šæŸ¥çœ‹ç½‘ç»œè¯·æ±‚
å¦‚æœæ•°æ®é€šè¿‡URLå‚æ•°ä¼ é€’ï¼Œå¯ä»¥åœ¨è¿”å›é¡µé¢çš„URLä¸­æŸ¥çœ‹ `experiment_data` å‚æ•°ã€‚

### æ–¹æ³•3ï¼šCredamoå˜é‡æ£€æŸ¥
åœ¨Credamoçš„ä¸‹ä¸€ä¸ªé¡µé¢ï¼Œæ£€æŸ¥ä¿å­˜çš„å˜é‡å€¼ã€‚

## ğŸ› ï¸ å¦‚æœéœ€è¦ä¿®æ”¹æ•°æ®ä¿å­˜æ–¹å¼

å¦‚æœä½ æƒ³å°†æ•°æ®ç›´æ¥å‘é€åˆ°æœåŠ¡å™¨ï¼Œå¯ä»¥ä¿®æ”¹ `index.html` ä¸­è¿”å›æŒ‰é’®çš„äº‹ä»¶å¤„ç†ï¼Œæ·»åŠ AJAXè¯·æ±‚ï¼š

```javascript
// å‘é€åˆ°æœåŠ¡å™¨
fetch('https://your-server.com/api/experiment-data', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
    },
    body: JSON.stringify(finalData)
});
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [README.md](README.md) - é¡¹ç›®æ€»è§ˆå’Œå¿«é€Ÿå¼€å§‹
- [Credamoé…ç½®æŒ‡å—.md](Credamoé…ç½®æŒ‡å—.md) - Credamoå¹³å°é…ç½®æ–¹æ³•
- [éƒ¨ç½²æŒ‡å—.md](éƒ¨ç½²æŒ‡å—.md) - GitHub Pageséƒ¨ç½²æ­¥éª¤

